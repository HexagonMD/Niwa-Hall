<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>旅行プランナー - Trip Planner</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="app-container">
        <!-- サイドバー -->
        <div class="sidebar" id="sidebar">
            <button class="nav-button active" data-view="idea" onclick="switchView('idea')">
                <span>💡</span>
                <span class="tooltip">アイデアスペース</span>
            </button>
            <button class="nav-button" data-view="map" onclick="switchView('map')">
                <span>📍</span>
                <span class="tooltip">マップ</span>
            </button>
            <button class="nav-button" data-view="flowchart" onclick="switchView('flowchart')">
                <span>📊</span>
                <span class="tooltip">フローチャート</span>
            </button>
            <button class="nav-button" data-view="bookmark" onclick="switchView('bookmark')">
                <span>&#x1F4D6;</span>
                <span class="tooltip">しおり</span>
            </button>
        </div>

        <!-- メインコンテンツ -->
        <div class="main-content">
            <!-- ヘッダー -->
            <div class="header">
                <h1 style="color: #2c3e50; font-size: 24px;">🗺️ 旅行プランナー</h1>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <button class="btn btn-secondary" onclick="startCollaboration()" id="collaborationBtn">
                        🤝 協働開始
                    </button>
                    <button class="btn btn-outline" onclick="leaveCollaboration()" id="leaveBtn" style="display: none;">
                        🚪 退出
                    </button>
                    <div class="user-indicator" style="display: flex; gap: 5px;">
                        <span id="statusIndicator"
                            style="width: 10px; height: 10px; background: #e74c3c; border-radius: 50%; margin-top: 5px;"></span>
                        <span style="color: #7f8c8d; font-size: 14px;" id="userCount">オフライン</span>
                    </div>
                </div>
            </div>

            <!-- 日程選択ツールバー -->
            <div class="common-toolbar">
                <div class="day-tabs">
                    <button class="day-tab active static">全日程</button>
                    <button class="day-tab static">未定</button>
                    <button id="addDayBtn" class="day-tab-add">+</button>
                </div>
            </div>

            <!-- ビューコンテナ -->
            <div class="view-container">
                <!-- アイデアスペース -->
                <div class="view idea-space active" id="idea-view">
                    <div class="idea-board" id="ideaBoard">
                    </div>
                </div>

                <!-- マップビュー -->
                <div class="view map-view" id="map-view">
                    <div class="map-toolbar">

                        <div class="map-search-container">
                            <input type="text" id="mapSearchInput" placeholder="場所を検索..." class="map-search-input">
                            <div id="mapSearchResults"></div>
                        </div>
                        <div style="flex: 1;"></div>
                    </div>
                    <div id="map"></div>
                </div>

                <!-- フローチャートビュー -->
                <div class="view flowchart-view" id="flowchart-view">
                    <div class="timeline" id="timeline">
                        <div class="timeline-item">
                            <div class="time-display">09:00</div>
                            <div class="timeline-content">
                                <div class="timeline-title">札幌駅集合</div>
                                <div class="timeline-duration">所要時間: 30分</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="time-display">09:30</div>
                            <div class="timeline-content">
                                <div class="timeline-title">大通公園散策</div>
                                <div class="timeline-duration">所要時間: 1時間</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="time-display">10:30</div>
                            <div class="timeline-content">
                                <div class="timeline-title">札幌時計台見学</div>
                                <div class="timeline-duration">所要時間: 45分</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="time-display">11:15</div>
                            <div class="timeline-content">
                                <div class="timeline-title">ラーメン横丁でランチ</div>
                                <div class="timeline-duration">所要時間: 1時間30分</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Bookmark View -->
                <div class="view bookmark-view" id="bookmark-view">
                    <div class="bookmark-content">
                        <div class="bookmark-controls">
                            <h2>しおり表紙設定</h2>
                            <div class="form-group">
                                <label for="bookmarkTitleInput">タイトル</label>
                                <input type="text" id="bookmarkTitleInput" placeholder="Trip Bookmark">
                            </div>
                            <div class="form-group">
                                <label for="bookmarkCoverInput">表紙画像</label>
                                <input type="file" id="bookmarkCoverInput" accept="image/*">
                                <div class="bookmark-cover-preview" id="bookmarkCoverPreview"></div>
                                <button type="button" class="btn btn-secondary" id="bookmarkCoverClearBtn">Clear Image</button>
                            </div>
                            <div class="form-group">
                                <label for="bookmarkBackgroundSelect">背景色</label>
                                <select id="bookmarkBackgroundSelect">
                                    <option value="#ffffff">ホワイト</option>
                                    <option value="#f8fafc">スモークホワイト</option>
                                    <option value="#fef3c7">クリーム</option>
                                    <option value="#e0f2fe">ライトブルー</option>
                                    <option value="#dcfce7">ミント</option>
                                    <option value="#f5f3ff">ラベンダー</option>
                                </select>
                            </div>
                        <p class="bookmark-note">日付ごとのスポットをベースにページを構成します。</p>
                        <button type="button" class="btn btn-primary bookmark-export-btn" id="bookmarkExportBtn">PDF出力</button>
                        </div>
                        <div class="bookmark-preview">
                            <div class="bookmark-pages" id="bookmarkPages"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- モーダル -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <form id="addForm">
                <div class="form-group">
                    <label>タイトル</label>
                    <input type="text" id="itemTitle" placeholder="例: おいしいラーメン屋">
                </div>
                <div class="form-group">
                    <label>説明</label>
                    <textarea id="itemDescription" placeholder="詳細な説明を入力..."></textarea>
                </div>
                <div class="form-group">
                    <label>写真（複数選択可）</label>
                    <input type="file" id="itemPhotos" multiple accept="image/*">
                    <div class="photo-previews" id="photoPreviews"></div>
                </div>
                <div class="form-group">
                    <label>URL</label>
                    <input type="url" id="itemUrl" placeholder="https://...">
                </div>
                <div class="form-group">
                    <label>開始時間</label>
                    <input type="time" id="itemStartTime">
                </div>
                <div class="form-group">
                    <label>所要時間</label>
                    <input type="text" id="itemDuration" readonly>
                </div>
                <div class="form-group">
                    <label>終了時間</label>
                    <input type="time" id="itemEndTime">
                </div>
                <div class="form-group">
                    <label>ピンの種類</label>
                    <div class="pin-types">
                        <div class="pin-type">
                            <input type="radio" name="pinType" value="food" id="food" checked>
                            <label for="food"><span class="pin-type-color" style="background: #e74c3c;"></span>
                                グルメ</label>
                        </div>
                        <div class="pin-type">
                            <input type="radio" name="pinType" value="sightseeing" id="sightseeing">
                            <label for="sightseeing"><span class="pin-type-color" style="background: #3498db;"></span>
                                観光</label>
                        </div>
                        <div class="pin-type">
                            <input type="radio" name="pinType" value="hotel" id="hotel">
                            <label for="hotel"><span class="pin-type-color" style="background: #27ae60;"></span>
                                宿泊</label>
                        </div>
                        <div class="pin-type">
                            <input type="radio" name="pinType" value="transport" id="transport">
                            <label for="transport"><span class="pin-type-color" style="background: #f39c12;"></span>
                                交通</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>日程</label>
                    <select id="itemDay">
                        <option value="0">未定</option>
                        <option value="1" selected>1日目</option>
                        <option value="2">2日目</option>
                        <option value="3">3日目</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">キャンセル</button>
                    <button type="submit" class="btn btn-primary">追加</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Socket.IO Client -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <!-- WebRTC Manager -->
    <script src="webrtc-manager.js"></script>
    <!-- UI Helpers -->
    <script src="ui.js"></script>
    <!-- Google Map周り -->
    <script src="map.js"></script>
    <!-- フローチャート関連 -->
    <script src="flowchart.js"></script>
    <!-- Main Application -->
    <script src="app.js"></script>
</body>

</html>

